<div class="regist">
  <nz-card style="">
    <ng-template #title>
      {{ 'regist.title' | translate }}
    </ng-template>
    <ng-template #extra>
    </ng-template>
    <ng-template #body>

      <form nz-form [formGroup]="validateForm" (ngSubmit)="_submitForm()">
        <div nz-form-item nz-row>
          <div nz-form-label nz-col [nzSm]="6" [nzXs]="24">
            <label for="email" nz-form-item-required>{{ 'regist.email' | translate }}</label>
          </div>
          <div nz-form-control nz-col [nzSm]="14" [nzXs]="24" nzHasFeedback>
            <nz-input [nzSize]="'large'" formControlName="email" [nzId]="'email'"></nz-input>
            <div nz-form-explain *ngIf="getFormControl('email').dirty&&getFormControl('email').hasError('email')">The input is not valid E-mail!</div>
          </div>
        </div>
        <div nz-form-item nz-row>
          <div nz-form-label nz-col [nzSm]="6" [nzXs]="24">
            <label for="password" nz-form-item-required>{{ 'regist.password' | translate }}</label>
          </div>
          <div nz-form-control nz-col [nzSm]="14" [nzXs]="24" nzHasFeedback>
            <nz-input [nzSize]="'large'" formControlName="password" [nzType]="'password'" [nzId]="'password'" (ngModelChange)="updateConfirmValidator()"></nz-input>
            <div nz-form-explain *ngIf="getFormControl('password').dirty&&getFormControl('password').hasError('required')">Please input your password!</div>
          </div>
        </div>
        <div nz-form-item nz-row>
          <div nz-form-label nz-col [nzSm]="6" [nzXs]="24">
            <label for="checkPassword" nz-form-item-required>{{ 'regist.confirm_password' | translate }}</label>
          </div>
          <div nz-form-control nz-col [nzSm]="14" [nzXs]="24" nzHasFeedback>
            <nz-input [nzSize]="'large'" formControlName="checkPassword" [nzType]="'password'" [nzId]="'checkPassword'"></nz-input>
            <div nz-form-explain *ngIf="getFormControl('checkPassword').dirty&&getFormControl('checkPassword').hasError('required')">Please confirm your password!</div>
            <div nz-form-explain *ngIf="getFormControl('checkPassword').dirty&&getFormControl('checkPassword').hasError('confirm')">Two passwords that you enter is inconsistent!</div>
          </div>
        </div>
        <div nz-form-item nz-row>
          <div nz-form-label nz-col [nzSm]="6" [nzXs]="24">
            <label for="userName" nz-form-item-required>
              <span>
                {{ 'regist.userName' | translate }}
                <nz-tooltip [nzTitle]="'What do you want other to call you'">
                  <i nz-tooltip class="anticon anticon-question-circle-o"></i>
                </nz-tooltip>
              </span>
            </label>
          </div>
          <div nz-form-control nz-col [nzSm]="14" [nzXs]="24" nzHasFeedback>
            <nz-input [nzSize]="'large'" formControlName="userName" [nzId]="'userName'"></nz-input>
            <div nz-form-explain *ngIf="getFormControl('userName').dirty&&getFormControl('userName').hasError('required')">Please input your nickname!</div>
          </div>
        </div>
        <div nz-form-item nz-row>
          <div nz-form-label nz-col [nzSm]="6" [nzXs]="24">
            <label for="phoneNumber" nz-form-item-required>{{ 'regist.phoneNumber' | translate }}</label>
          </div>
          <div nz-form-control nz-col [nzSm]="14" [nzXs]="24" nzHasFeedback [nzValidateStatus]="validateForm.controls['phoneNumber']">
            <nz-input-group [nzSize]="'large'" nzCompact>
              <nz-select formControlName="phoneNumberPrefix" style="width: 25%;">
                <nz-option [nzLabel]="'+86'" [nzValue]="'+86'"></nz-option>
                <nz-option [nzLabel]="'+87'" [nzValue]="'+87'"></nz-option>
              </nz-select>
              <input formControlName="phoneNumber" id="'phoneNumber'" nz-input style="width: 75%;">
            </nz-input-group>
            <div nz-form-explain *ngIf="getFormControl('phoneNumber').dirty&&getFormControl('phoneNumber').hasError('required')">Please input your phone number!</div>
          </div>
        </div>
        <div nz-form-item nz-row>
          <div nz-form-label nz-col [nzSm]="6" [nzXs]="24">
            <label for="captcha" nz-form-item-required>{{ 'regist.captcha' | translate }}</label>
          </div>
          <div nz-form-control nz-col [nzSm]="14" [nzXs]="24">
            <div nz-row [nzGutter]="8">
              <div nz-col [nzSpan]="8">
                <nz-input [nzSize]="'large'" formControlName="captcha" [nzId]="'captcha'"></nz-input>
              </div>
              <div nz-col [nzSpan]="12">
                <img src="{{captcha?.image}}" width="100%" alt="" srcset="">
              </div>
              <div nz-col [nzSpan]="4">
                <button nz-button [nzSize]="'large'" (click)="getCaptcha($event)"><i class="anticon anticon-sync"></i></button>
              </div>
            </div>
            <div nz-form-extra>We must make sure that your are a human.</div>
            <div nz-form-explain *ngIf="getFormControl('captcha').dirty&&getFormControl('captcha').hasError('required')">Please input the captcha you got!</div>
          </div>
        </div>
        
      </form>
      <div  nz-row style="margin-bottom:8px;">
        <div nz-col [nzSpan]="14" [nzOffset]="6">
          <label nz-checkbox [(ngModel)]="agree">
            <span>{{'regist.agrementPrompt'|translate}} <a>{{'regist.agrementLink'|translate}}</a></span>
          </label>
        </div>
      </div>
      <div nz-form-item nz-row style="margin-bottom:8px;">
        <div nz-form-control nz-col [nzSpan]="14" [nzOffset]="6">
          <button nz-button [nzSize]="'large'" *ngIf="!agree" [nzType]="'primary'" disabled>Register</button>
          <button nz-button [nzSize]="'large'" *ngIf="agree" [nzType]="'primary'" (click)="_submitForm($event)">Register</button>
        </div>
      </div>

    </ng-template>
  </nz-card>
</div>
